!function(_){"use strict";var r="#fw-wizard-container",t="#fw-elements-container";function v(){"console"in window&&console.log.apply(console,arguments)}function n(){"console"in window&&console.warn.apply(console,arguments)}function o(e,a){_('<div id="fw-alert" style="background-color:'+(a?"#4caf50":"#f44336")+'">'+e+"</div>").hide().appendTo("#wpbody-content").slideDown().delay(3e3).slideUp()}function m(e,a){var i='<div class="fw-radio-option-element" data-type="option">';return i+='<input type="text" class="fw-radio-option" placeholder="'+wizard.i18n.radio.option+" "+a+'" value="'+e+'"></input>',i+='<div class="fw-remove-radio-option"><i class="fa fa-minus-circle" aria-hidden="true"></i></div></div>'}function s(e){v("block",e);var a,i,t,l,r,n,o,s,c,d,p,f,u,b,w='<div class="fw-step-block" data-type="'+e.type+'" >';switch(w+='<div class="fw-block-controls">',w+='<i class="fa fa-remove fw-remove-block" title="'+wizard.i18n.tooltips.removeBlock+'" aria-hidden="true"></i>',w+='<i class="fa fa-caret-up fw-toggle-block" aria-hidden="true"></i>',w+="</div>",w+=(a=e.type,i='<div class="fw-block-action fw-block-hndle">',i+='<i class="fa fa-arrows fw-move-block fw-block-hndle" aria-hidden="true"></i>',i+="<h4>"+a+"</h4>",i+="</div>"),w+='<div class="fw-block-fields">',e.type){case"radio":e.elements||(e.elements=[{type:"header",value:""},{type:"option",value:""}]),w+=function(e){v("radio",e);var a,i,t,l,r,n=0,o="";for(o+='<div class="fw-radio-option-container">',a=0,i=e.elements.length;a<i;a++)v("element",t=e.elements[a]),"option"===t.type?(1==a&&(o+="<label>"+wizard.i18n.radio.options+"</label>"),o+=m(t.value,1+n++)):o+=(l=t.value,r=void 0,r='<div class="fw-radio-option-element" data-type="header"><label>'+wizard.i18n.label+"</label>",r+='<input type="text" class="fw-radio-header fw-block-label" value="'+l+'"></input>',r+="</div>");return o+="</div>",o+='<button class="fw-radio-add"><i class="fa fa-plus" aria-hidden="true"></i> '+wizard.i18n.radio.addOption+"</button><br/>",o+='<label><input type="checkbox" class="fw-required"'+x(e.required)+"/> "+wizard.i18n.required+"</label>","true"==e.multichoice?o+='<label><input type="checkbox" class="fw-radio-multichoice" checked/>'+wizard.i18n.radio.multiple+' <i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.multiChoice+'"></i></label>':o+='<label><input type="checkbox" class="fw-radio-multichoice"/>'+wizard.i18n.radio.multiple+' <i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.multiChoice+'"></i></label>',o}(e);break;case"select":e.elements||(e.elements=[]),w+=function(e){v("select",e);var a=0,i="",t=wizard.i18n.select.placeholder?wizard.i18n.select.placeholder:"";for(i+='<div class="fw-select-option-container">',i+="<label>"+wizard.i18n.label+"</label>",i+='<input type="text" class="fw-block-label" value="'+e.label+'"></input>',i+="<label>"+t+"</label>",i+='<input type="text" class="fw-select-placeholder" value="'+e.placeholder+'"></input>',i+="<label>"+wizard.i18n.select.options+"</label>",i+='<textarea class="fw-select-options" rows="4" cols="50">',a=0;a<e.elements.length;a++)i+=e.elements[a]+"\n";return i+="</textarea>",i+="</div>",i+='<label><input type="checkbox" class="fw-select-search"'+x(e.search)+"/>"+wizard.i18n.select.search+"</label>",i+='<label><input type="checkbox" class="fw-required"'+x(e.required)+"/> "+wizard.i18n.required+"</label>"}(e);break;case"checkbox":w+=function(e){v("checkbox",e);var a="";return a+="<label>"+wizard.i18n.label+"</label>",a+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',a+='<label><input type="checkbox" class="fw-required"'+x(e.required)+"/>"+wizard.i18n.required+"</label>"}(e);break;case"text":w+=function(e){v("textInput",e);var a="";return a+="<label>"+wizard.i18n.label+"</label>",a+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',a+='<label><input type="checkbox" class="fw-required"'+x(e.required)+"/>"+wizard.i18n.required+"</label>"}(e);break;case"email":w+=(u=e,b="",b+="<label>"+wizard.i18n.label+"</label>",b+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+u.label+'"></input><br/>',b+='<label><input type="checkbox" class="fw-required"'+x(u.required)+"/>"+wizard.i18n.required+"</label>");break;case"numeric":w+=(p=e,f="",f+="<label>"+wizard.i18n.label+"</label>",f+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+p.label+'"></input><br/>',f+='<label><input type="checkbox" class="fw-required"'+x(p.required)+"/>"+wizard.i18n.required+"</label>",f+="<label>"+wizard.i18n.numeric.minimum+"</label>",f+='<input type="text" class="fw-numeric-minimum fw-block-label" placeholder="'+wizard.i18n.numeric.no_minimum+'" value="'+(p.minimum?p.minimum:"")+'" pattern="-?\\d*"></input><br/><br/>',f+="<label>"+wizard.i18n.numeric.maximum+"</label>",f+='<input type="text" class="fw-numeric-maximum fw-block-label" placeholder="'+wizard.i18n.numeric.no_maximum+'" value="'+(p.maximum?p.maximum:"")+'" pattern="-?\\d*"></input><br/>');break;case"file":w+=(c=e,d="",d+="<label>"+wizard.i18n.label+"</label>",d+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+c.label+'"></input><br/>',d+='<label><input type="checkbox" class="fw-file-multi"'+x(c.multi)+"/>"+wizard.i18n.multifile+"</label>",d+='<label><input type="checkbox" class="fw-required"'+x(c.required)+"/>"+wizard.i18n.required+"</label>");break;case"date":w+=(o=e,s="",s+="<label>"+wizard.i18n.label+"</label>",s+='<input type="text" class="fw-text-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+o.label+'"></input><br/>',s+="<label>"+wizard.i18n.dateformat+'<a target="_blank" href="http://t1m0n.name/air-datepicker/docs/#sub-section-9"><i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.dateformat+'"></i></a></label>',s+='<input type="text" class="fw-date-format fw-block-label" placeholder="'+wizard.i18n.dateformat+'" value="'+(o.format?o.format:"yy-mm-dd")+'" ></input><br/>',s+='<label><input type="checkbox" class="fw-required"'+x(o.required)+"/>"+wizard.i18n.required+"</label>");break;case"textarea":w+=function(e){v("textArea",e);var a="";return a+="<label>"+wizard.i18n.label+"</label>",a+='<input type="text" class="fw-textarea-label fw-block-label" placeholder="'+wizard.i18n.label+'" value="'+e.label+'"></input><br/>',a+='<label><input type="checkbox" class="fw-required"'+x(e.required)+"/>"+wizard.i18n.required+"</label>"}(e);break;case"paragraph":w+=(r=e,n="",n+="<label>"+wizard.i18n.paragraph.textHtml+' <i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.paragraph+'"></i></label>',n+='<textarea class="fw-paragraph-text fw-block-label" placeholder="'+wizard.i18n.paragraph.text+'">'+(r.text?r.text:"")+"</textarea>",n+='<label style="display:none;"><input type="checkbox" class="fw-required"'+x(r.required)+"/>"+wizard.i18n.required+"</label>");break;case"registration":w+=(l="",l+='<label><input type="checkbox" class="fw-required"'+x((t=e).required)+"/>"+wizard.i18n.required+"</label>",l+='<p class="msfp-registration-info">'+wizard.i18n.registration.info+"</p>",l+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-email" checked disabled="disabled"/>'+wizard.i18n.registration.email+"</label>",l+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-username" checked disabled="disabled"/>'+wizard.i18n.registration.username+"</label>",l+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-password"'+x(t.password)+"/>"+wizard.i18n.registration.password+"</label>",l+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-firstname"'+x(t.firstname)+"/>"+wizard.i18n.registration.firstname+"</label>",l+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-lastname"'+x(t.lastname)+"/>"+wizard.i18n.registration.lastname+"</label>",l+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-website"'+x(t.website)+"/>"+wizard.i18n.registration.website+"</label>",l+='<label class="msfp-registration-option"><input type="checkbox" class="msfp-registration-bio"'+x(t.bio)+"/>"+wizard.i18n.registration.bio+"</label>")}return w+="</div>",w+='<div class="fw-clearfix"></div>',w+="</div>"}function c(e,a){v("part",e);var i='<div class="'+a+'">';return i+='<div class="fw-section-hndle"><i class="fa fa-arrows"></i></div>',i+='<input type="text" class="fw-part-title" value="'+e.title+'" placeholder="'+wizard.i18n.partTitle+'"></input>',i+='<div class="fw-remove-part" title="'+wizard.i18n.removeSection+'">',i+='<i class="fa fa-remove"></i>',i+='</div><div class="inside connectedSortable">',i+=function(e){var a,i,t="";for(a=0,i=e.length;a<i;a++)if("conditional"==e[a].type){t+=s(e[a].block);var l={prec_block_id:e[a].prec_block_id,prec_operator:e[a].prec_operator,prec_value:e[a].prec_value,visible:e[a].visible};t=t.slice(0,-6),t+='<input class="msf-block-meta" name="msf-block-meta-'+a+'" type="hidden" value="'+encodeURI(JSON.stringify(l))+'">',t+="</div>"}else t+=s(e[a]);return t}(e.blocks),i+='</div><div class="fw-add-element">',i+='<a href="#TB_inline?width=400&height=200&inlineId=fw-thickbox-content" class="thickbox"><i class="fa fa-plus"></i> '+wizard.i18n.addElement+"</a>",i+="</div>",i+="</div>"}function i(e,a){var i="fw-headline-"+a,t="fw-copy-text-"+a,l='<div class="fw-step"><div class="form-wrap">';return l+='<div class="input form-field">',l+='<label for="'+("fw-title-"+a)+'"><b>'+wizard.i18n.title+"</b>",l+='<i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.title+'"></i></label>',l+='<input type="text" class="fw-step-title" value="'+e.title+'"></input>',l+="</div>",l+='<div class="input form-field">',l+='<label for="'+i+'"><b>'+wizard.i18n.headline+"</b>",l+='<i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.tooltips.headline+'"></i></label>',l+='<input type="text" class="fw-step-headline" value="'+e.headline+'"></input>',l+="</div>",l+='<div class="input form-field">',l+='<label for="'+t+'"><b>'+wizard.i18n.copyText+"</b>",l+='<i class="fa fa-info-circle" aria-hidden="true" title="'+wizard.i18n.copyText+'"></i></label>',l+='<input type="text" class="fw-step-copy_text" value="'+e.copy_text+'"></input>',l+="</div>",l+='<div class="fw-step-parts">'+function(e){var a,i=e.length,t='<div><div class="fw-parts-header"><h3>Sections</h3></div>';for(t+='<div class="fw-column-buttons">',t+='<button type="button" class="fw-button-one-column"><i class="fa fa-align-justify"></i></button>',t+='<button type="button" class="fw-button-two-columns"><i class="fa fa-align-justify"></i> <i class="fa fa-align-justify"></i></button>',t+="</div>",t+='<div class="fw-parts-container">',a=0,i=e.length;a<i;a++)t+=c(e[a],"fw-step-part");return t+="</div>",t+='<div class="fw-parts-footer">',t+='<a class="fw-add-part"><i class="fa fa-plus"></i> '+wizard.i18n.addSection+"</a>",t+="</div>",t+="</div>"}(e.parts)+"</div>",l+='</div><div class="fw-clearfix"></div></div>'}function l(e){var a='<div class="postbox">';return a+='<div class="fw-movediv hndle ui-sortable-handle"><i class="fa fa-arrows"></i></div>',a+='<h1 class="fw-step-h1 hndle ui-sortable-handle"><span>',a+=e.title+"</span></h1>",a+='<div class="fw-step-controls">',a+='<i class="fa fa-remove fw-remove-step" title="'+wizard.i18n.tooltips.removeStep+'" aria-hidden="true"></i>',a+='<i class="fa fa-caret-up fw-toggle-step" aria-hidden="true"></i>',a+='<i class="fa fa-files-o fw-duplicate-step" title="duplicate step" aria-hidden="true"></i>',a+="</div>",a+='<div class="fw-clearfix"></div>',a+=i(e),a+='<div class="fw-clearfix"></div>',a+="</div>"}function d(e){var a,i,t,l,r,n,o,s,c,d,p,f,u,b,w,v,m,h,k,g,x,y,z,q={};switch(q.type=e.attr("data-type")){case"radio":x=e,z=(y=q).elements=[],x.find(".fw-radio-option-element").each(function(e,a){var i,t,l;z.push((i=_(a),"option"===(l=(t={}).type=i.attr("data-type"))?t.value=i.find(".fw-radio-option").val():"header"===l&&(t.value=i.find(".fw-radio-header").val()),t))}),y.required=x.find(".fw-required").prop("checked"),y.multichoice=x.find(".fw-radio-multichoice").prop("checked");break;case"select":k=q,g=(h=e).find(".fw-select-options").val().split("\n"),k.required=h.find(".fw-required").prop("checked"),k.search=h.find(".fw-select-search").prop("checked"),k.label=h.find(".fw-block-label").val(),k.placeholder=h.find(".fw-select-placeholder").val(),k.elements=g.filter(function(e){return""!==e&&" "!==e});break;case"checkbox":v=e,(m=q).label=v.find(".fw-text-label").val(),m.required=v.find(".fw-required").prop("checked");break;case"text":b=e,(w=q).label=b.find(".fw-text-label").val(),w.required=b.find(".fw-required").prop("checked");break;case"email":f=e,(u=q).label=f.find(".fw-text-label").val(),u.required=f.find(".fw-required").prop("checked");break;case"numeric":d=e,(p=q).label=d.find(".fw-text-label").val(),p.required=d.find(".fw-required").prop("checked"),p.minimum=d.find(".fw-numeric-minimum").val(),p.maximum=d.find(".fw-numeric-maximum").val();break;case"file":s=e,(c=q).label=s.find(".fw-text-label").val(),c.required=s.find(".fw-required").prop("checked"),c.multi=s.find(".fw-file-multi").prop("checked");break;case"date":n=e,(o=q).label=n.find(".fw-text-label").val(),o.format=n.find(".fw-date-format").val(),o.required=n.find(".fw-required").prop("checked");break;case"textarea":l=e,(r=q).label=l.find(".fw-textarea-label").val(),r.required=l.find(".fw-required").prop("checked");break;case"paragraph":t=e,q.text=t.find(".fw-paragraph-text").val();break;case"registration":a=e,(i=q).required=a.find(".fw-required").prop("checked"),i.password=a.find(".msfp-registration-password").prop("checked"),i.firstname=a.find(".msfp-registration-firstname").prop("checked"),i.lastname=a.find(".msfp-registration-lastname").prop("checked"),i.website=a.find(".msfp-registration-website").prop("checked"),i.bio=a.find(".msfp-registration-bio").prop("checked")}return q}function p(e){var a={};a.title=e.find(".fw-part-title").val();var r=a.blocks=[];return e.find(".fw-step-block").each(function(e,a){var i,t,l=_(a);l.find(".msfp-conditional").prop("checked")?r.push(((t={type:"conditional"}).visible=(i=l).find(".msfp-conditional-visible").val(),t.prec_block_id=i.find(".msfp-conditional-prec-block-id").val(),t.prec_operator=i.find(".msfp-conditional-prec-op").val(),t.prec_value=i.find(".msfp-conditional-prec-value").val(),t.block=d(i),t)):r.push(d(l))}),a}function f(e){var a={};a.title=e.find(".fw-step-title").val(),a.headline=e.find(".fw-step-headline").val(),a.copy_text=e.find(".fw-step-copy_text").val();var i=a.parts=[];return e.find(".fw-step-part").each(function(e,a){i.push(p(_(a)))}),a}function u(e){var a,i,t,l=!0;return""===e.title?(l=!1,o(wizard.i18n.alerts.noFormTitle,!1)):l=function(e){for(var a=!0,i=0;i<e.length;i++)if(e[i].title)for(var t=0;t<e[i].parts.length;t++){""===e[i].parts[t].title&&(a=!1,o(wizard.i18n.alerts.noSectionTitle,!1));for(var l=0;l<e[i].parts[t].blocks.length;l++)e[i].parts[t].blocks[l]}else a=!1,o(wizard.i18n.alerts.noStepTitle,!1);return a}(e.wizard.steps)&&(a=e.wizard.settings,t=!0,(i=a.to)&&/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(i)?a.subject||(t=!1,_("#fw-nav-settings").trigger("click"),o(wizard.i18n.alerts.noSubject,!1)):(t=!1,_("#fw-nav-settings").trigger("click"),o(wizard.i18n.alerts.invalidEmail,!1)),t),l}function b(){var e,a=_(r),i=_(".fw-wizard-title").val(),t={wizard:{}};t.wizard.title=i,t.wizard.steps=[],t.wizard.settings=((e={}).thankyou=_(".fw-settings-thankyou").val(),e.to=_(".fw-mail-to").val(),e.frommail=_(".fw-mail-from-mail").val(),e.fromname=_(".fw-mail-from-name").val(),e.subject=_(".fw-mail-subject").val(),e.header=_(".fw-mail-header").val(),e.headers=_(".fw-mail-headers").val(),e);var l=a.find(".fw-step");l.each(function(e,a){l.length;t.wizard.steps.push(f(_(a)))}),t.wizard.steps.push(),u(t)&&(v("save",t),_.ajax({type:"POST",url:wizard.ajaxurl,dataType:"json",data:{action:"fw_wizard_save",data:t,nonce:wizard.nonce,id:wizard.id},success:function(e){void 0!==e.data.nonce&&(wizard.nonce=e.data.nonce),wizard.id=e.data.id,o(e.data.msg,e.success)},error:function(e){v("fail",arguments),v("response",e)}}))}function w(){_(".meta-box-sortables").sortable({opacity:.6,revert:!0,cursor:"move",handle:".hndle",tolerance:"pointer",placeholder:"fw-block-placeholder",start:function(e,a){var i=_(a.item).height();_(".fw-block-placeholder").height(i)},update:function(e,a){n("sortables update",e,a),_(a.item).removeAttr("style"),w(),h()}}),_(".fw-step-part .inside").sortable({opacity:.6,cursor:"move",connectWith:".connectedSortable",handle:".fw-block-hndle",tolerance:"intersect",placeholder:"fw-block-placeholder",revert:100,start:function(e,a){var i=_(a.item).height(),t=_(".fw-block-placholder");t.height(i),t.attr("data-type",a.item.attr("data-type"))},update:function(e,a){n("block sortables update",e,a);var i=_(a.item).attr("data-type"),t=-1;if(_(a.item).is(".fw-draggable-block"))if("registration"===i&&y())o("Only one registration block allowed!",!1),_(a.item).remove();else{var l=_(s({type:i,label:""}));_(a.item).replaceWith(l),t=_(".fw-step-block").index(l)}w(),h(),T(),msfp&&setupConditionals(t)}}),_(".fw-parts-container").sortable({opacity:.6,cursor:"move",connectWith:".fw-parts-container",handle:".fw-section-hndle",tolerance:"intersect",placeholder:"fw-section-placeholder",revert:100,start:function(e,a){var i=_(a.item).height();_(".fw-section-placeholder").height(i)},update:function(e,a){w(),h(),T()}});_(t+" .fw-draggable-block").draggable({connectToSortable:".fw-step-part .inside",revert:"invalid",helper:"clone",cursor:"move"}),_(r).find(".fw-step-title").on("change input",e)}function h(){_(".fa-info-circle").tooltip(),_(".fw-remove-step").tooltip(),_(".fw-duplicate-step").tooltip(),_(".fw-remove-part").tooltip(),_(".fw-remove-block").tooltip(),_(".hndle.ui-sortable-handle").tooltip()}function e(e){var a=_(this);v("titleOnChangeU",a.val()),a.closest(".postbox").find("h1 > span").html(a.val())}function k(e){e.find('.fw-radio-option-element[data-type="option"] > label').each(function(e,a){v("updateOptions",a),_(a).html("Option "+(e+1))})}function g(e){var a=_(".fw-step").length;if(a<5||msfp)if(a<10){var i=_(l(e));i.appendTo(_(r).find(".meta-box-sortables")),T(),w(),C(),0<a&&_("html, body").animate({scrollTop:_(document).height()-i.height()-180},500)}else o(wizard.i18n.alerts.onlyTen,!1);else o(wizard.i18n.alerts.onlyFive,!1)}function x(e){var a="";return"true"==e&&(a="checked"),a}function y(){var i=!1;return _(".fw-step-block").each(function(e,a){"registration"==_(a).attr("data-type")&&(i=!0)}),i}function z(){var e=_(this).closest(".postbox");!0===confirm(wizard.i18n.alerts.reallyDeleteStep)&&e.slideUp(700,function(){e.remove()})}function q(e){var a=_(e.target).closest(".fw-step-part");!0===confirm(wizard.i18n.alerts.reallyDeleteSection)&&a.slideUp(500,function(){a.remove()})}function C(){_(".thickbox").click(function(t){_("#fw-thickbox-radio").unbind("click").click(function(e){tb_remove();var a=_(s({type:"radio"}));_(t.target).parents(".fw-step-part").find(".inside").append(a),T()}),_("#fw-thickbox-select").unbind("click").click(function(e){tb_remove();var a=_(s({type:"select",label:""}));_(t.target).parents(".fw-step-part").find(".inside").append(a),T()}),_("#fw-thickbox-text").unbind("click").click(function(e){tb_remove();var a=_(s({type:"text",label:"",value:""}));_(t.target).parents(".fw-step-part").find(".inside").append(a),T()}),_("#fw-thickbox-email").unbind("click").click(function(e){tb_remove();var a=_(s({type:"email",label:"",value:""}));_(t.target).parents(".fw-step-part").find(".inside").append(a),T()}),_("#fw-thickbox-numeric").unbind("click").click(function(e){tb_remove();var a=_(s({type:"numeric",label:"",value:"",minimum:"",maximum:""}));_(t.target).parents(".fw-step-part").find(".inside").append(a),T()}),_("#fw-thickbox-fileupload").unbind("click").click(function(e){tb_remove();var a=_(s({type:"file",label:"",value:""}));_(t.target).parents(".fw-step-part").find(".inside").append(a),T()}),_("#fw-thickbox-textarea").unbind("click").click(function(e){tb_remove();var a=_(s({type:"textarea",label:"",value:""}));_(t.target).parents(".fw-step-part").find(".inside").append(a),T()}),_("#fw-thickbox-date").unbind("click").click(function(e){tb_remove();var a=_(s({type:"date",label:"",format:"yy-mm-dd"}));_(t.target).parents(".fw-step-part").find(".inside").append(a),T()}),_("#fw-thickbox-paragraph").unbind("click").click(function(e){tb_remove();var a=_(s({type:"paragraph",text:""}));_(t.target).parents(".fw-step-part").find(".inside").append(a),T()}),_("#fw-thickbox-registration").unbind("click").click(function(e){tb_remove();var a=_(s({type:"registration",label:"",value:""})),i=_(t.target).parents(".fw-step-part");y()?o("Only one registration block allowed!",!1):i.find(".inside").append(a),T()})})}function S(e){-1!=_("input[type=text]").index(_(e.target))&&(-1==_.inArray(e.keyCode,[37,38,39,40,48,49,50,51,52,53,54,55,56,57,58,96,97,98,99,100,101,102,103,104,105,8,13,189])||189==e.keyCode&&-1!=_(e.target).val().indexOf("-")||198==e.keyCode&&0!=_(e.target).val().length)&&e.preventDefault()}function T(){_(".fw-element-step").unbind("click").click(function(e){g({title:"",headline:"",copy_text:"",parts:[{title:"",blocks:[]}]})}),_(".fw-duplicate-step").unbind("click").click(function(e){var a,i=_(this).parent().parent().find(".fw-step");(a=f(i)).title+=" (COPY)",g(a)}),_(".fw-add-part").unbind("click").click(function(e){var a,i;a=e.target,i=c({title:"",blocks:[]},"fw-step-part"),_(a).closest(".fw-step-parts").find(".fw-parts-container").append(i),_(".fw-remove-part").click(function(e){q(e)}),C(),w()}),_(".fw-toggle-step").unbind("click").click(function(e){_(this).parent().parent().find(".fw-step").slideToggle(),_(this).toggleClass("fw-icon-rotated")}),_(".fw-remove-part").unbind("click").click(function(e){q(e)}),_(".fw-remove-block").unbind("click").click(function(e){var a,i;a=_(e.target).closest(".fw-step-block"),i=a.find(".fw-block-label").val(),!0===confirm(wizard.i18n.alerts.reallyDeleteBlock+"\n\n"+i)&&a.slideUp(300,function(){a.remove()})}),_(".fw-toggle-block").unbind("click").click(function(e){var a=_(this).parent().parent();if(a.toggleClass("fw-block-collapsed"),a.hasClass("fw-block-collapsed")){var i=a.find(".fw-block-label").val();a.find("h4").text(i),_(this).addClass("fw-icon-rotated")}else{var t=a.data("type");a.find("h4").text(t),_(this).removeClass("fw-icon-rotated")}})}_(document).ready(function(){try{var e=JSON.parse(wizard.json),a=_(r);e.wizard.title?_(".fw-wizard-title").val(e.wizard.title):_(".fw-wizard-title").val("My Multi Step Form"),function(e){var a,i,t='<div class="postbox-container"><div class="metabox-holder"><div class="meta-box-sortables">';for(a=0,i=e.length;a<i;a++)t+=l(e[a]);t+="</div>",t+='<a class="fw-element-step"><i class="fa fa-plus"></i> '+wizard.i18n.addStep+"</a>",t+="</div></div>",_(r).html(t)}(e.wizard.steps&&0<e.wizard.steps.length?e.wizard.steps:[{title:"",headline:"",copy_text:"",parts:[{title:"",blocks:[]}]}]),(i=e.wizard.settings)&&(i.thankyou&&_(".fw-settings-thankyou").val(i.thankyou),i.subject&&_(".fw-mail-subject").val(i.subject),i.to&&_(".fw-mail-to").val(i.to),i.frommail&&_(".fw-mail-from-mail").val(i.frommail),i.fromname&&_(".fw-mail-from-name").val(i.fromname),i.header&&_(".fw-mail-header").val(i.header),i.headers&&_(".fw-mail-headers").val(i.headers)),_(".fw-button-save").click(b),_(window).scroll(function(){_(".nav-tab-wrapper").height()+19<_(this).scrollTop()?_(t).addClass("fw-sticky"):_(t).removeClass("fw-sticky")}),a.on("click",".postbox .handlediv",function(){_(this).closest(".postbox").toggleClass("closed")}),a.on("click",".fw-radio-add",function(){var e=_(this).prev(".fw-radio-option-container"),a=m("",e.children(".fw-radio-option-element").length);_(a).appendTo(e),k(e)}),a.on("click",".fw-remove-radio-option",function(){v("remove on click");var e=_(this),a=e.closest(".fw-radio-option-container");e.closest(".fw-radio-option-element").remove(),k(a)}),a.on("keydown",".fw-numeric-minimum",S),a.on("keydown",".fw-numeric-maximum",S),a.on("click",".fw-remove-step",z),w(),h(),C(),T(),_("#fw-nav-settings").click(function(e){_("#fw-nav-steps").toggleClass("nav-tab-active"),_("#fw-nav-settings").toggleClass("nav-tab-active"),_(r).hide(),_(t).hide(),_(".fw-mail-settings-container").show()}),_("#fw-nav-steps").click(function(e){_("#fw-nav-steps").toggleClass("nav-tab-active"),_("#fw-nav-settings").toggleClass("nav-tab-active"),_(".fw-mail-settings-container").hide(),_(r).show(),_(t).show()}),_("#fw-elements-modal").dialog({dialogClass:"wp-dialog",modal:!0,autoOpen:!1,closeOnEscape:!0,buttons:{Close:function(){_(this).dialog("close")}}})}catch(e){n(e)}var i})}(jQuery);